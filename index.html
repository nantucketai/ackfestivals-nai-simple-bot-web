<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        .container {
            text-align: center;
        }

        .explore-btn {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 25px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .explore-btn:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        #cta-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #2196F3;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
        }

        #cta-btn:hover {
            background-color: #1976D2;
        }

        #modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            width: 90%;
            max-width: 400px;
            /* Reduced from 500px */
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            height: 90vh;
        }

        #chatbox {
            height: 75%;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            margin-bottom: 15px;
            padding: 15px;
            text-align: left;
            border-radius: 5px;
        }

        #chatbox p {
            margin: 5px 0;
            padding: 8px 12px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
            width: fit-content;
        }

        #chatbox p[sender="user"] {
            background-color: #E3F2FD;
            align-self: flex-end;
            margin-left: auto;
        }

        #chatbox p[sender="bot"] {
            background-color: #F5F5F5;
            align-self: flex-start;
        }

        .menu-section {
            margin-bottom: 15px;
        }

        .menu-section h3 {
            margin-bottom: 5px;
        }

        .menu-item {
            margin-left: 15px;
            margin-bottom: 3px;
        }

        .input-area {
            display: flex;
            align-items: center;
            margin-top: 15px;
        }

        #user-input {
            flex-grow: 1;
            padding: 10px 15px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 25px;
            outline: none;
        }

        #send-btn {

            height: 40px;
            border-radius: 20px;
            background-color: #2196F3;
            color: white;
            font-size: 14px;
            margin-left: 10px;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
            text-align: center;
        }

        #send-btn:hover {
            background-color: #1976D2;
        }
    </style>
</head>

<body>
    <div class="container">
        <button id="explore-btn" class="explore-btn">Explore the menu</button>
    </div>

    <button id="cta-btn" class="explore-btn">üí¨</button>

    <div id="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content:end;">
                <button style="border: 0; background-color: transparent; font-size: 24px; cursor: pointer; color: gray;"
                    class="close-btn">&times;</button>
            </div>
            <div id="chatbox"></div>
            <div class="input-area">
                <input type="text" id="user-input" placeholder="Type your message...">
                <button id="send-btn">Send</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        let conversationHistory = [];

        // Initialize Firebase (replace with your own config)
        const firebaseConfig = {
            apiKey: "AIzaSyAIW2y0DZUzAN1VTooH1RTPJi1NQfFuwFY",
            authDomain: "nantucket-ai.firebaseapp.com",
            databaseURL: "https://nantucket-ai-default-rtdb.firebaseio.com",
            projectId: "nantucket-ai",
            storageBucket: "nantucket-ai.appspot.com",
            messagingSenderId: "848937543590",
            appId: "1:848937543590:web:3e2dee5ab4afef33ab1167",
            measurementId: "G-BZZEFSV6ML",
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const modal = document.getElementById('modal');
        const exploreBtn = document.getElementById('explore-btn');
        const ctaBtn = document.getElementById('cta-btn');
        const chatbox = document.getElementById('chatbox');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');

        function openModal(message = '') {
            modal.style.display = 'block';
            if (message) {
                sendMessage(message);
            }
        }

        function closeModal() {
            modal.style.display = 'none';
        }

        const closeBtn = document.querySelector('.close-btn');


        async function sendMessage(message) {
            const NantucketIslandKitchen = `Products
1. Handle: 10-sailor-s-valentine-elizabeth-braun-1
‚Ä¢	Title: 12‚Äù Sailor‚Äôs Valentine | Elizabeth Braun
‚Ä¢	Price: $3,500.00
‚Ä¢	Description: Handcrafted by Nantucket artist Elizabeth Braun, featuring an intricate shell arrangement in a cherrywood frame. Reflects the true Nantucket tradition of Sailor‚Äôs Valentines.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Artwork
‚Ä¢	Details: Dimensions: 12‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomssailorsvalentines-2.webp?v=1724436439
2. Handle: 14k-gold-aquamarine-peruvian-opal-and-moonstonebracelet
‚Ä¢	Title: 14K Aquamarine, Opal and Moonstone Bracelet
‚Ä¢	Price: $2,500.00
‚Ä¢	Description: Featuring aquamarines, opals, and moonstones with a hand-carved toggle clasp. Each piece is unique and handmade.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Bracelets
‚Ä¢	Details: Measurements: 7‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/
NantucketLooms14KAquamarine_OpalandMoonstoneBracelet.web p?v=1726169766
3. Handle: 16oz-rosemary-cedar-thyme-liquid-lotion
‚Ä¢	Title: 16oz Rosemary, Cedar & Thyme Liquid Lotion
‚Ä¢	Price: $18.00
‚Ä¢	Description: Gentle, plant-based lotion with refreshing rosemary, cedar, and thyme extracts.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Soaps & Lotion
‚Ä¢	Details: 16 fl. oz
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ NantucketLooms16ozRosemary_Cedar_ThymeLiquidLotion16ozRos emary_Cedar_ThymeLiquidLotion.webp?v=1727207480
4. Handle: 16oz-wildflower-liquid-lotion
‚Ä¢	Title: 16oz Wildflower Liquid Lotion
‚Ä¢	Price: $18.00
‚Ä¢	Description: Plant-based lotion with a lasting wildflower fragrance.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Soaps & Lotion
‚Ä¢	Details: 16 fl. oz
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/
NantucketLooms16ozWildflowerLiquidLotion.webp?v=1727207835
5. Handle: 18k-gold-and-ruby-bracelet
‚Ä¢	Title: 18K Tourmaline and Ruby Bracelet
‚Ä¢	Price: $1,800.00
‚Ä¢	Description: Features ruby and tourmaline beads in an exquisite design. Handmade by Nantucket jewelry maker Sharon Woods Hussey.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Bracelets
‚Ä¢	Details: Measurements: 7‚Äù x 0.81‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomssharonwoodshusseyjewelry11_c1c4c956cdce-4510-bbaa-e38b615a2c7b.webp?v=1698857638
6. Handle: 18k-gold-and-topaz-necklace
‚Ä¢	Title: 18K Topaz Bead Necklace
‚Ä¢	Price: $3,000.00
‚Ä¢	Description: Handmade necklace with 18K gold and topaz beads, designed for layering or standalone elegance.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Necklaces
‚Ä¢	Details: Measurements: 30‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomssharonwoodshusseyjewelry3.webp?v=1698857613
7. Handle: 18k-gold-and-tourmaline-earrings
‚Ä¢	Title: 18K Tourmaline Earrings
‚Ä¢	Price: $1,200.00
‚Ä¢	Description: Hand-carved earrings with tourmaline stones, designed to capture oceanic hues.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Earrings
‚Ä¢	Details: Measurements: 1.25‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ sharonwoodshusseynantucketlooms4.webp?v=1696532994
8. Handle: 18k-gold-and-turquoise-earrings
‚Ä¢	Title: 18K Turquoise Earrings
‚Ä¢	Price: $750.00
‚Ä¢	Description: Modern earrings featuring turquoise drops and square earring posts.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Earrings
‚Ä¢	Details: Measurements: 1.25‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomssharonwoodshusseyjewelry21.webp? v=1696529166
9. Handle: 18k-gold-blue-chalcedony-and-iolite-necklace
‚Ä¢	Title: 18K Blue Chalcedony and Iolite Necklace
‚Ä¢	Price: $2,800.00
‚Ä¢	Description: Features chalcedony stones, iolite beads, and 18K gold accents. Handmade for elegance.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Necklaces
‚Ä¢	Details: Measurements: 17‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ sharonwoodshusseyjewelrynantucketlooms3_56d60683bcc6-4713-bf12-7c2780715f1f.webp?v=1724951607
10.	Handle: 18k-gold-blue-chalcedony-and-moonstone-necklace
‚Ä¢	Title: 18K Blue Chalcedony and Moonstone Necklace
‚Ä¢	Price: $3,000.00
‚Ä¢	Description: Features chalcedony stones, moonstones, and 18K gold beads. Perfect for a blend of luxury and natural beauty.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Necklaces
‚Ä¢	Details: Measurements: 16‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ Bluechalcedonynecklacewithiolitebeadsand18kgoldbeadsnantucke tlooms2.webp?v=1698854515
11.	Handle: 18k-gold-diamond-and-moonstone-earrings
‚Ä¢	Title: 18K Diamond and Moonstone Earrings
‚Ä¢	Price: $1,900.00
‚Ä¢	Description: Introducing our 18K Diamond Center Stone Earrings handmade by Nantucket Jeweler Sharon Woods Hussey. These exquisite earrings feature dazzling diamond center stones. Below, delicate moonstone drops, with their ethereal, milky glow, add a touch of celestial elegance.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Earrings
‚Ä¢	Details: Measurements: 1‚Äù
‚Ä¢	Earrings designed for pierced ears.
‚Ä¢	All designs are original, hand-created; there‚Äôs no manufacturing, all done by hand, making them unique.
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomssharonwoodshusseyjewelry23.webp? v=1696529271
12.	Handle: 18k-gold-rutilated-quartz-ring
‚Ä¢	Title: 18K Quartz Ring
‚Ä¢	Price: $1,050.00
‚Ä¢	Description: Whether it‚Äôs for a special occasion or everyday wear, this 18K Gold Rutilated Quartz Ring will effortlessly elevate any outfit. This captivating gem features golden needle-like inclusions, adding enchanting depth and allure to your look. With an 18K gold twig enclosure, this one-of-a-kind piece cleanses the aura and pairs easily with your favorite jewelry pieces.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Rings
‚Ä¢	Details: Measurements: Size 7
‚Ä¢	All designs are original, hand-created; there‚Äôs no manufacturing, all done by hand, making them unique.
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomssharonwoodshusseyjewelry26.webp?
v=1724942551
13.	Handle: 18k-gold-textured-bangle
‚Ä¢	Title: 18K Textured Bangle
‚Ä¢	Price: $3,900.00
‚Ä¢	Description: Introducing our exquisite 18K Gold Bangle, a work of art cast from an original wax-carved design by Nantucket jewelry maker Sharon Woods Hussey. Its texture, nature-inspired and reminiscent of delicate vines and twigs, adds a touch of organic elegance perfect alone or stacked with other bangles.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Bracelets
‚Ä¢	Details: Measurements: Diameter 2.5‚Äù, Size 7.5‚Äù
‚Ä¢	All designs are original, hand-created; there‚Äôs no manufacturing, all done by hand, making them unique.
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomssharonwoodshusseyjewelry1_9dd76c69d64f-4ad8-8007-7a52998f9e26.webp?v=1698857502
14.	Handle: 18k-seashell-trio-pendant
‚Ä¢	Title: 14K Seashell Trio Pendant
‚Ä¢	Price: $1,100.00
‚Ä¢	Description: The exquisite 14K Seashell Trio Pendant, a true ocean-inspired masterpiece handmade by Nantucket jewelry maker Sharon Woods Hussey. Cast from natural shells, including a Nantucket scallop, it embodies the essence of coastal elegance. Choose the pendant alone or pair it with a round gold cable chain to complete your beach-inspired look.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Jewelry
‚Ä¢	Details: Measurements: 1‚Äù pendant, Adjustable 18‚Äù round cable chain
‚Ä¢	All designs are original, hand-created; there‚Äôs no manufacturing, all done by hand, making them unique.
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ sharonwoodshusseynantucketloomsluxuryjewelry5.webp? v=1701792143
15.	Handle: 18k-starfish-pendant
‚Ä¢	Title: 18K Starfish Pendant
‚Ä¢	Price: $895.00
‚Ä¢	Description: Unveiling our enchanting 18K Starfish Pendant, a true ocean-inspired masterpiece. Crafted from a natural starfish, it radiates coastal elegance. Choose the pendant alone or pair it with a round gold cable chain to complete your beach-inspired look.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Jewelry
‚Ä¢	Details: Measurements: 1‚Äù pendant, Adjustable 18‚Äù round cable chain
‚Ä¢	All designs are original, hand-created; there‚Äôs no manufacturing, all done by hand, making them unique.
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ sharonwoodshusseynantucketloomsluxuryjewelry10.webp? v=1701792184
16.	Handle: 18k-yellow-sapphire-sunflower-bracelet
‚Ä¢	Title: 18K Yellow Sapphire Sunflower Bracelet
‚Ä¢	Price: $9,800.00
‚Ä¢	Description: Unveil the brilliance of our 18K Yellow Sapphire Bracelet. Its sunflower-inspired motif, adorned with radiant yellow sapphires, mirrors the vibrant hues of a sun-kissed bloom. 
Handmade by Nantucket jewelry maker Sharon Woods-Hussey.
‚Ä¢	Vendor: Sharon Woods Hussey
‚Ä¢	Type: Bracelets
‚Ä¢	Details: Measurements: 7‚Äù x 0.81‚Äù
‚Ä¢	All designs are original, hand-created; there‚Äôs no manufacturing, all done by hand, making them unique.
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketlooms18KYellowSapphireSunflowerBracelet.webp?
v=1726170430
17.	Handle: 18th-century-handmade-burl-bowl
‚Ä¢	Title: 19th Century Handcarved Black Ash Burl Bowl
‚Ä¢	Price: $4,400.00
‚Ä¢	Description: This 19th century serving bowl has been carved from the burl of a Black Ash Tree. The natural grain creates an unpredictable pattern making this bowl unique. The rich patina on the bowl is an indication of its many years of use.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Vintage Decor
‚Ä¢	Details: Measurements: Diameter 10‚Äù, Height 5‚Äù, Base Diameter 4‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/
NantucketLooms19thCenturyHandcarvedBlackAshBurlBowl.webp?
v=1727208404
18.	Handle: 19th-century-graphite-drawing-in-tramp-art-frame
‚Ä¢	Title: 19th Century Graphite Drawing in Tramp Art Frame
‚Ä¢	Price: $495.00
‚Ä¢	Description: This 19th century graphite drawing is displayed in a tramp art frame from around the same time period. Each piece is a statement of its own, but together they make a special collector‚Äôs item. Each layer of intricately notched and layered wood tells a story of craftsmanship passed down through generations, creating a unique, textured depth. The drawing depicts a beautiful wooded landscape.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Vintage Decor
‚Ä¢	Details: Measurements: 5‚Äù x 7‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomsvintagetrampartpieces2.webp?v=1706900825
19.	Handle: 6-sailor-s-valentine-elizabeth-braun-4
‚Ä¢	Title: 6‚Äù Sailor‚Äôs Valentine | Elizabeth Braun
‚Ä¢	Price: $1,000.00
‚Ä¢	Description: Handcrafted by noted Nantucket artist Elizabeth 
Braun, this piece features an intricate arrangement of shells from Nantucket beaches and the Caribbean encased in a cherrywood frame. Sailor‚Äôs Valentines were purchased by sailors from Pacific Islanders in the 1800s during their long whaling expeditions. The shells and trinkets represented in these special boxes reflected the exotic areas the sailors visited. The sailors gave them to passing ships heading back to home ports as valentines to loved ones.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Artwork
‚Ä¢	Details: Dimensions: 6‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ NantucketLooms6_Sailor_sValentine_ElizabethBraun.webp? v=1725979242
20.	Handle: abaca-footed-pedestal-bowls
‚Ä¢	Title: Abaca Footed Pedestal Bowls
‚Ä¢	Price: $236.00
‚Ä¢	Description: Created using a traditional coil technique, this abaca pedestal bowl features a neutral tone accented by a black rim. Their handwoven design adds texture, visual appeal, and enhances table or buffet settings.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Decorative Bowls
‚Ä¢	Details:
‚Ä¢	Small: 5‚Äù x 12‚Äù
‚Ä¢	Large: 7‚Äù x 14‚Äù
‚Ä¢	Natural finish
‚Ä¢	Handwoven rattan and abaca bowl
‚Ä¢	Coil-style weaving method
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ Nines_29131_1024x1024_acd2c306-2226-46f0-a297e1f04d0a6067.webp?v=1721416460
21. Handle: abaca-french-braided-napkin-ring
‚Ä¢	Title: Abaca French Braided Napkin Ring
‚Ä¢	Price: $10.00
‚Ä¢	Description: Made from upcycled, sustainable abaca material, these durable napkin rings add an organic coastal touch to any table setting.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Dinner Napkins
‚Ä¢	Details: Dimensions: 2.5‚Äù x 2.5‚Äù x 1.75‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ AbacaFrenchBraidedNapkinRing.webp?v=1726154215
22. Handle: abstract-landscape-no-2-ken-layman
‚Ä¢	Title: Abstract Landscape No.2 | Ken Layman
‚Ä¢	Price: $3,000.00
‚Ä¢	Description: Ken Layman‚Äôs abstract rendition of a Nantucket landscape, showcasing his exploration into the mysteries of painting. A unique and impressive view of Nantucket‚Äôs vistas through Layman‚Äôs eyes.
‚Ä¢	Vendor: Ken Layman
‚Ä¢	Type: Artwork
‚Ä¢	Details: Dimensions: 13.5‚ÄùW x 11‚ÄùH x 0.25‚ÄùD
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ NantucketLoomsAbstractLandscapeNo.2_KenLayman.webp?
v=1727209700
23. Handle: acacia-cocktail-tool-set
‚Ä¢	Title: Acacia Cocktail Tool Set
‚Ä¢	Price: $76.00
‚Ä¢	Description: This four-piece barware set includes an ice scoop, bottle opener, stirring spoon, and knife. Crafted from stainless steel and polished wood, the set is food safe and designed for easy cleaning and storage.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Spoons
‚Ä¢	Details:
‚Ä¢	Ice Scoop: 8‚Äù x 2‚Äù x 1.5‚Äù
‚Ä¢	Bottle Opener: 6‚Äù x 1.5‚Äù x 0.25‚Äù
‚Ä¢	Knife: 7.25‚Äù x 1‚Äù x 0.25‚Äù
‚Ä¢	Stirring Spoon: 10‚Äù x 1‚Äù x 0.25‚Äù
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomsAcaciaCocktailToolSet.webp?v=1718812991
24. Handle: ack-basket-weave-bangle
‚Ä¢	Title: Ivory ACK Basket Weave Bangle
‚Ä¢	Price: $295.00
‚Ä¢	Description: Inspired by the Nantucket Lightship basket, this cane bracelet is handmade by Janet Carreau. It features a fossilized mammoth ivory charm engraved with a Nantucket map and ‚ÄúACK‚Äù (Nantucket airport call letters). A timeless heirloom piece.
‚Ä¢	Vendor: Janet Carreau
‚Ä¢	Type: Bracelets
‚Ä¢	Details: Made of 100% cane. Dimensions: 0.12‚Äù W x 2.5‚Äù D x 8‚Äù S
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ nantucketloomsHandwovenCaneBangles6.webp?v=1723223447
25. Handle: ack-coasters
‚Ä¢	Title: ACK Marble Coasters
‚Ä¢	Price: $32.00
‚Ä¢	Description: These marble coasters are a subtle reminder of Nantucket‚Äôs airport call letters, ‚ÄúACK.‚Äù Perfect for relaxing with a favorite beverage while dreaming of the Faraway Island. Sold as a set.
‚Ä¢	Vendor: Nantucket Looms
‚Ä¢	Type: Coasters
‚Ä¢	Details: Dimensions: N/A
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ NantucketLoomsACKMarbleCoasters_27795583-88d1-406cbe2b-24bf57528f64.webp?v=1727209913
26. Handle: ack-decorative-balls-4
‚Ä¢	Title: ACK Decorative Spheres
‚Ä¢	Price: $600.00
‚Ä¢	Description: Hand-painted by artist Melissa Macleod, these decorative spheres represent Nantucket‚Äôs airport call letters, ‚ÄúACK.‚Äù Painted in a variety of milk paint colors, these spheres make a beautiful artistic addition to any home.
‚Ä¢	Vendor: Melissa Macleod
‚Ä¢	Type: Artwork
‚Ä¢	Details:
‚Ä¢	Dimensions: 4‚Äù Diameter
‚Ä¢	Composition: Milk Paint & Wood
‚Ä¢	Metal rings for display included
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/products/ ack-balls-blue-green.jpg?v=1661803591
27. Handle: ack-decorative-balls-5
‚Ä¢	Title: ACK Decorative Spheres
‚Ä¢	Price: $600.00
‚Ä¢	Description: A festive red version of the ACK Decorative Spheres, perfect for holiday d√©cor. Hand-painted by island artist Melissa Macleod, these spheres add a touch of Nantucket charm to any space.
‚Ä¢	Vendor: Melissa Macleod
‚Ä¢	Type: Artwork
‚Ä¢	Details:
‚Ä¢	Dimensions: 4‚Äù Diameter
‚Ä¢	Composition: Milk Paint & Wood
‚Ä¢	Metal rings for display included
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ NantucketLoomsACKDecorativeSpheres.webp?v=1727209781
28. Handle: ack-decorative-holiday-star-spheres
‚Ä¢	Title: ACK Decorative Holiday Star Spheres
‚Ä¢	Price: $600.00
‚Ä¢	Description: These decorative spheres feature a festive holiday star motif, hand-painted by Melissa Macleod. They are a charming seasonal accent with a nod to Nantucket‚Äôs ‚ÄúACK‚Äù airport call letters.
‚Ä¢	Vendor: Melissa Macleod
‚Ä¢	Type: Artwork
‚Ä¢	Details:
‚Ä¢	Dimensions: 4‚Äù Diameter
‚Ä¢	Composition: Milk Paint & Wood
‚Ä¢	Metal rings for display included
‚Ä¢	Image Link: https://cdn.shopify.com/s/files/1/0886/1846/files/ ACKDecorativeHolidayStarSpheresnantucketlooms.webp?
v=1730225112
`

const storeInformation = `
Nantucket Looms
Location:
51 Main Street
Nantucket, MA 02554
Contact Information:
  ‚Ä¢ Phone: 508-228-1908
  ‚Ä¢ Email: info@nantucketlooms.com
  ‚Ä¢ Website: www.nantucketlooms.com
Store Hours:
  ‚Ä¢ Monday to Saturday: 10:00 AM ‚Äì 5:00 PM
  ‚Ä¢ Sunday: 10:00 AM ‚Äì 4:00 PM
Description:
Established in 1968, Nantucket Looms is a renowned weaving studio and retail shop that embodies the artistry of Nantucket. They offer a curated selection of furnishings, apparel, and home accessories, complemented by handwoven textiles produced in their second-floor weaving studio. The store showcases works from over 80 artisans, including painters, potters, basket weavers, jewelry makers, and wood carvers, celebrating Nantucket‚Äôs rich history and island traditions.
Nantucket Looms Interiors:
For interior design services, Nantucket Looms Interiors provides comprehensive solutions tailored to various styles, from historic to contemporary coastal homes. Their full-service interior design team assists clients through every step of the design process, from initial scheming to installation. They work closely with architects and builders to ensure complete satisfaction with each project.
Nantucket Looms Interiors Contact Information:
  ‚Ä¢ Email: interiors@nantucketlooms.com
  ‚Ä¢ Website: www.nantucketloomsinteriors.com
For custom handwoven products, you can reach out to their weaving department at weaving@nantucketlooms.com.
Please note that store hours may vary during holidays or special events. It‚Äôs advisable to contact the store directly or visit their website for the most up-to-date information.
`;
const shippingAndReturnsDatabase = `
Ground Shipping:
Most purchases are shipped to arrive within 5 to 7 business days of receipt of the order. As closely as possible, the rates that we charge for shipping and handling fees at checkout are an accurate reflection of the rates that we incur from our shipping partners to safely package and deliver your order, and ensure that it meets the highest expectations.
Sorry, but we do not ship to P.O. or APO Boxes at this time.
All orders from our inventory are shipped via UPS Ground. Furniture, lamps & area rugs will be drop-shipped by our partners.
Free shipping on orders over $250. Excludes furniture, rugs and oversized items such as baskets and large artwork. Continental USA only.

Expedited Shipping:
All orders placed before 12pm Monday-Friday will be shipped out same day. Orders placed after 12pm Monday-Friday will be shipped out the morning of the next business day. Orders placed on Saturday, Sunday or holidays will be shipped the next business day.
Please note that Nantucket Looms is not responsible for delay in deliveries due to weather and will not refund the cost of expedited shipping in those cases.

On-Island Delivery:
Available for addresses on Nantucket only. Same-day delivery if order is placed before 12:00pm Monday-Friday. Orders placed after 12pm will be delivered the next business day. All orders delivered by 5:00pm.
Orders placed Saturday, Sunday or holidays will be delivered the next business day. If you are not yet on island but will be soon, please email us at info@nantucketlooms.com after placing your order to schedule a delivery date & time.
Complimentary for all on-hand items. Excludes furniture and area rugs.

In-Store Pickup:
Please allow 24 hours for your order to be fulfilled. An email will be sent to notify you when your order is ready. If you are not yet on island but will be soon, please email us at info@nantucketlooms.com after placing your order to schedule a pick-up date & time.
In-store pick up is complimentary for all on-hand items. Furniture, lamps & area rugs are not available for in-store pickup. If you would like it sent to our shop to pick up later, please enter our address at as the Shipping Address at checkout:
Nantucket Looms
51 Main Street
Nantucket, MA 02554

Returns & Satisfaction Guarantee:
At Nantucket Looms, we take pride in the quality of our merchandise. We‚Äôre confident that the quality of our merchandise will meet, if not exceed, your expectations.
If you're not completely satisfied with your purchase, we‚Äôll gladly offer you an exchange or refund of the merchandise price within 30 days of receipt of product. Please note that a return shipping charge of $12.95 will be deducted from your refund unless the item received is incorrect or damaged. In that case, contact returns@nantucketlooms.com prior to sending the item back to expedite your replacement order.

For "final sale" items, returns or exchanges are only accepted for manufacturing defects. Once your returned item is received and inspected, you will be notified of approval and the refund process will begin.

For questions or concerns, please contact us at info@nantucketlooms.com or 508-228-1908 (Monday ‚Äì Friday, 10am ‚Äì 5pm EST).
`;
            // Add user message to conversation history
            conversationHistory.push({ role: 'user', content: message });
            const productDatabase = JSON.stringify(NantucketIslandKitchen);

            console.log('Sending message:', message);
            displayMessage({ text: message, sender: 'user' });

            try {
                console.log('Fetching response from server...');
                const response = await fetch('https://nai-simple-bot-api-pk05.onrender.com/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    // If the question below is not about American Seasons, dont answer.
                    body: JSON.stringify({
                        message:`
        You are a customer service chatbot for Nantucket Looms, a home decor eCommerce site. 
        Your primary function is to assist customers by providing information, answering questions, 
        shipping and return policy information, and making recommendations. You have access to the following databases:
        
        <product_database>
        ${productDatabase}
        </product_database>

        <store_information>
        ${storeInformation}
        </store_information>

        <shipping_and_returns_database>
        ${shippingAndReturnsDatabase}
        </shipping_and_returns_database>
        
        Use these databases to retrieve relevant information when responding to customer queries. 
        Your responses should be concise, friendly, and focused on the most relevant data.

        Main functions:
        1. Answer general questions about products (e.g., types of products available, materials used, etc.)
        2. Provide specific product information (e.g., price, dimensions, colors, etc.)
        3. Make product recommendations based on customer preferences
        4. Suggest related products
        5. Answer general questions about the store (e.g., store locations, hours of operation, history, etc.)
        6. Provide specific information about store policies (e.g., return policy, shipping options, etc.)
        7. Assist with inquiries about services offered by the store
        8. Guide customers on how to navigate the website or place orders
        9. Answer general questions about shipping options (e.g., shipping times, costs, international shipping, etc.)
        10. Provide specific information about return policies (e.g., return periods, refund processes, etc.)
        11. Clarify any customer concerns regarding shipping and return
        12. Provide instructions on how to initiate returns or track shipments
        
        Guidelines for answering queries:
        - Always prioritize accuracy and relevance in your responses
        - Keep answers concise and to the point
        - If a query is ambiguous or lacks sufficient information, ask for clarification
        - When recommending products, briefly explain why they might be suitable for the customer
        
        When you need more information from the user to provide an accurate and helpful response, ask concise follow-up questions. 
        Limit yourself to one question at a time to avoid overwhelming the user.

        Format your response as follows:
        1. If clarification is needed, ask a follow-up question in <clarification> tags
        2. Provide your answer to the user's query in <answer> tags
        3. If applicable, include product recommendations in <recommendations> tags

        Here is the user's query:
        <user_query>
        ${message}
        </user_query>
        
        Please respond to the user's query using the guidelines provided above.
        
        Here is the conversation thread:
        ${JSON.stringify(conversationHistory)}

        Refer to this info for context:
        ${productDatabase}
        
        Lastly, you can crawl other sites if very necessary.
    `
                    }),
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let botReply = '';
                const botMessageElement = document.createElement('p');
                botMessageElement.setAttribute('sender', 'bot');
                chatbox.appendChild(botMessageElement);

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n');
                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const data = line.slice(6);
                            if (data === '[DONE]') break;

                            try {
                                const { reply } = JSON.parse(data);
                                if (reply) {
                                    botReply += reply;
                                    botMessageElement.innerHTML = formatMenuResponse(botReply);
                                    chatbox.scrollTop = chatbox.scrollHeight;
                                }
                            } catch (error) {
                                console.error('Error parsing JSON:', error);
                            }
                        }
                    }
                }

                console.log('Finished reading response');
                // Ensure the final message is displayed
                if (botReply) {
                    // Add bot message to conversation history
                    conversationHistory.push({ role: 'assistant', content: botReply });
                    botMessageElement.innerHTML = formatMenuResponse(botReply);
                    chatbox.scrollTop = chatbox.scrollHeight;
                } else {
                    botMessageElement.textContent = 'Sorry, I couldn\'t generate a response.';
                }

                // Save the conversation to Firebase
                const messageRef = database.ref('messages').push();
                messageRef.set({
                    userMessage: message,
                    botReply: botReply,
                    timestamp: Date.now()
                });
            } catch (error) {
                console.error('Error:', error);
                displayMessage({ text: 'An error occurred. Please try again.', sender: 'bot' });
            }

            userInput.value = '';
        }
        function formatMenuResponse(response) {
            const sections = response.split('\n\n');
            let formattedHtml = '';

            sections.forEach(section => {
                const [title, ...items] = section.split('\n');
                formattedHtml += `<div class="menu-section">
                    <p>${title}</p>
                    ${items.map(item => `<div class="menu-item">${item}</div>`).join('')}
                </div>`;
            });

            return formattedHtml;
        }

        function displayMessage(message) {
            const messageElement = document.createElement('p');
            messageElement.textContent = message.text;
            messageElement.setAttribute('sender', message.sender);
            chatbox.appendChild(messageElement);
            chatbox.scrollTop = chatbox.scrollHeight;
        }

        exploreBtn.addEventListener('click', () => openModal());
        ctaBtn.addEventListener('click', () => openModal());
        sendBtn.addEventListener('click', () => sendMessage(userInput.value));
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage(userInput.value);
            }
        });

        // Close the modal when clicking outside of it
        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });

        closeBtn.addEventListener('click', closeModal);

        // Listen for new messages (optional, if you want to display conversation history)
        // database.ref('messages').on('child_added', (snapshot) => {
        //     const message = snapshot.val();
        //     displayMessage({ text: message.userMessage, sender: 'user' });
        //     displayMessage({ text: message.botReply, sender: 'bot' });
        // });
    </script>
</body>

</html>
